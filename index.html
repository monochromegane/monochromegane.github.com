<!doctype html><html><head><meta name=generator content="Hugo 0.59.0"><meta charset=utf-8><meta name=viewport content="width=device-width"><meta name=author content><title>THINKING MEGANE</title><meta name=twitter:card content="summary"><meta name=twitter:site content="@monochromegane"><meta property="og:description" content="THINKING MEGANE"><meta property="og:title" content="THINKING MEGANE"><meta property="og:url" content="https://blog.monochromegane.com/"><meta property="og:image" content="https://blog.monochromegane.com/images/ogp.png"><link rel=stylesheet href=/css/reset.css><link rel=stylesheet href="//fonts.googleapis.com/css?family=Source+Code+Pro" type=text/css><link rel=stylesheet href="//fonts.googleapis.com/css?family=Montserrat" type=text/css><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/ir_black.min.css><link rel=stylesheet href=/css/text.css><link rel=stylesheet href=/css/color.css><link rel=stylesheet href=/css/layout.css><link rel=apple-touch-icon-precomposed sizes=57x57 href=/images/apple-touch-icon-57-precomposed.png><link rel=apple-touch-icon-precomposed sizes=114x114 href=/images/apple-touch-icon-114-precomposed.png><link rel=apple-touch-icon-precomposed sizes=72x72 href=/images/apple-touch-icon-72-precomposed.png><link rel=apple-touch-icon-precomposed sizes=144x144 href=/images/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/images/favicon.ico><link rel=canonical href=https://blog.monochromegane.com/><link href=https://blog.monochromegane.com/index.xml rel=alternate type=application/rss+xml title="THINKING MEGANE"><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML" async>MathJax.Hub.Config({HTML:["input/TeX","output/HTML-CSS"],TeX:{Macros:{bm:["\\boldsymbol{#1}",1],argmax:["\\mathop{\\rm arg\\,max}\\limits"],argmin:["\\mathop{\\rm arg\\,min}\\limits"]},extensions:["AMSmath.js","AMSsymbols.js"],equationNumbers:{autoNumber:"AMS"}},extensions:["tex2jax.js"],jax:["input/TeX","output/HTML-CSS"],tex2jax:{inlineMath:[['$','$'],["\\(","\\)"]],displayMath:[['$$','$$'],["\\[","\\]"]],processEscapes:true},"HTML-CSS":{availableFonts:["TeX"],linebreaks:{automatic:true}}});</script></head><body><div class=header><header><h1 class=logo><a href=https://blog.monochromegane.com>THINKING MEGANE</a></h1><nav><ul class=menu><li><a href=/self-introduction/>Home</a></li><li><a href=/post/>Archives</a></li><li><a href=/diary/>Diary</a></li><li><a href=http://thinking-megane.blogspot.jp/>Old Blog</a></li></ul></nav></header></div><div class=container><div class=posts><article><div class=post><header><h1><a href=https://blog.monochromegane.com/blog/2020/01/26/exhalation-and-coherently-fittable-system/>テッド・チャン『息吹』と「なめらかなシステム」</a></h1><time><div class=day><i class="fa fa-calendar-o day-icon"></i>2020-01-26</div></time></header><div class=post-inner><p>昨年末にあんちぽさんからお勧めされていた、テッド・チャン『息吹』をようやっと読み終えた。</p><p>本書を通して所属する研究所のビジョンである「なめらかなシステム」の世界観について理解が深まったように感じたのでメモしておく。</p><p>本書は表題の「息吹」を含むSFの短編集である。全部で9編の作品から成る。
多くの作品は、現在の地球の水準より進んだ技術とそれを扱う知性体が登場する。
登場人物は世界を左右するような運命や世界をまたにかける使命など帯びていないどこにでもいるような人々であることが多い。
（『イブの時間』などが雰囲気としては近いかもしれない）
彼ら彼女らはただ、彼らにとっては当然となった新しい技術に起因する変化に彼ら彼女らなりに適応していく。
この技術と変化の設定がリアリティを持っているがゆえに、読者はそう遠くない未来に地球の技術水準が到達した後に発生するであろう変化に対して自分ならばどうするかと没入感を持って作品にのめり込む。</p><p>さて研究所のビジョンとしての「<a href=https://rand.pepabo.com/papers/dicomo2018-proceeding-antipop.pdf>なめらかなシステム</a>」であるが、情報システムとこれを取り巻く要素が互いに影響を及ぼし合う総体としてのシステム観である。
これに対し、以前に「<a href=/blog/2019/03/01/the-things-coherently-fittable-system-looks-ahead-to>なめらかなシステムの見据えるもの。個人的考察</a>」のエントリで、なめらかであることの必然性を問いの発端としてその未来像を検討した。
その際は、「個性」というキーワードで、システムと接する要素が多様かつ継続的に変化することを前提としてこれにシステム側が適応することがこの必然性につながると考えた。
いわば、システムを利用する要素（特に人間）が主でシステムが従のような捉え方であった。
ここで、「なめらかなシステム」自体は、要素間に主従の考えは導入していないにも関わらず、個人の感性としてバイアス的にこのような考えが導入されてしまったと思う。
そのためか、互いに影響を及ぼし合うと言いつつも、システムの利用側としては、そのシステムとそのタスクに限定された影響（例えば、情報要求の前進、あるいは具体化など）程度に収まると考えていた。</p><p>一方で、今回の読書を通して、一段階規模を広げたシステム観に思い至れた。
もし、個別のシステムを超えて、全体としての技術水準やパラダイムのような圧倒的な変化があれば、主従が変化し、そのような技術に追従するために人生観や哲学でさえも（好むと好まざるに関わらず）そこに適応しなければならない。
「なめらかなシステム」においては、ある意味、これまでであれば受け手側が制御不能なレベルでの変化をも適応していきたい。</p><p>今回、単一のシステムから技術、パラダイムの変化にまで拡大してシステム観を適用して考える契機になったと思う。
僕にとって発想を広げるのはSFを読む醍醐味であり、今回の作品は大いにこれが達成されて満足している。
興味を持った方は是非読んで欲しい。
短編集なので1時間程度の空きがあれば少しづつ読み進めることができると思う。
代表作の「息吹」だけでも読んで欲しいし、「ソフトウェア・オブジェクトのライフサイクル」「偽りのない事実、偽りのない気持ち」「オムファロス」「不安は自由のめまい」もお勧めしたい。</p><iframe style=width:120px;height:240px marginwidth=0 marginheight=0 scrolling=no frameborder=0 src="https://rcm-fe.amazon-adsystem.com/e/cm?ref=qf_sp_asin_til&t=monochromeg03-22&m=amazon&o=9&p=8&l=as1&IS2=1&detail=1&asins=4152098996&linkId=c80e18f474ae1d11bcfb8c9f739235ab&bc1=ffffff&lt1=_blank&fc1=333333&lc1=0066c0&bg1=ffffff&f=ifr"></iframe></div><footer class=tag><i class="fa fa-tags tag-icon"></i><ul><li><a class=tag-link href=/tags/%E6%83%85%E5%A0%B1%E8%A6%81%E6%B1%82>情報要求</a></li></ul><div class=clear></div></footer></div></article><article><div class=post><header><h1><a href=https://blog.monochromegane.com/blog/2019/12/31/2019/>2019</a></h1><time><div class=day><i class="fa fa-calendar-o day-icon"></i>2019-12-31</div></time></header><div class=post-inner><p>今年は研究とGo言語三昧だった。
特にGo言語については、福岡でGoConを開催し、GopherCon2019で初の海外カンファレンスに登壇した。
大規模カンファレンスの主催も海外の大きなカンファレンスでの登壇も初めての経験で準備もプレッシャーも大変だったが、多くの人と笑いながら協力しながらなんとか達成することができたと思う。
これらの経験は自分の行動の幅を世界基準に広げるにあたって大きな自信につながった。
加えて、コミュニティ活動として主催するFukuoka.goを他の地方コミュニティと同時開催したり、Go言語教室を招いたり、OSS Gateのメンター、Fukuoka.LTの運営をやったりと精力的に福岡のコミュニティを全国とつなげ、盛り上げることができた。
来年もGo言語を武器にどんどん活動していきたい。</p><p>研究については、当初目標だったジャーナルには残念ながら不採録となったものの、改めて研究を発展させ年内に再度投稿することができた。
今年執筆した論文とそのフィードバックから、研究の背景（動機、位置付け、従来課題の整理）は一定のレベルで書けるようになったのではないかと感じる。
一方で、提案手法とその評価に関する指摘の割合が多くなってきており、改めて提案手法の貢献を明確にできるよう考え抜いていかなければならない。
これまでの研究を通して「常に変化しうる多数の環境に対する自律適応的なシステムとその仕組み」が背景にあるのではないかと考えており、来年はこの観点でのサーベイと体系化を進めていきたい。</p><p>2019年をかけて、多くのことを達成することができた。
特に精神的な面では強くなれたのでないかと思う。
上期の前半は、研究で実績が出ないことに対する焦りや力不足でまたも袋小路に入ってしまったが、アドバイスや助力いただけたことで立て直すことができた。
それでも、何かをやることに対する漠然とした恐怖や、過度な専念などいくつかの弱体化がかかっていたように思う。
結局は、無能だと判断されたくないだとか、集中することができれば大きな成果を出せるはずだとか、心の奥底に対外的な評価が中心に据えられて、自己評価とのギャップと相まって動けなくなっていたことが原因だと思い至り、過去の理性の人のエントリを見返しつつ、自分を大切に、なすべきことをやっていけるよう少しづつ冷静になれた。
周りからの評価を恐れてやるべきことを見失ったり曲げてしまうのはとても悲しいことだし、
生きている以上、やることは常に発生するのだから、これらを後回しにすることは長期的には専念にはならないし、
色々なことに向き合う必要があるのだから、人や結果に過度にひきづられることを言い訳にせずに個々の事象をある程度独立させて淡々とこなして行くのが良いのだろう。</p><p>来年は、数学、英語、サーベイを継続的にこなしつつジャーナルを通して博士課程に挑戦する。
また、トップダウンの視点をもって行動の意義を共有することで影響力を高めていこうと思う。
2020年もよろしくお願いします。</p><h1 id=実績>実績</h1><p>以下、実績を列挙する。</p><h2 id=論文>論文</h2><p>国内査読無し論文が2本と国内査読付きポスター発表が1本。執筆としては査読付き論文が2本。うち1本が不採録で、投稿中が1本。</p><ol><li>三宅 悠介, 栗林 健太郎, Kaburaya AutoScaler: 多環境での運用性を考慮した自律適応型オートスケーリング制御系, インターネットと運用技術シンポジウム論文集, 2019, pp.114-115, Nov 2019. <a href=https://rand.pepabo.com/papers/iots2019-miyakey.pdf>[論文]</a> <a href=https://speakerdeck.com/monochromegane/iots2019-kaburaya-autoscaler>[発表資料]</a></li><li>三宅 悠介, 阿部 博, 栗林 健太郎, <a href=http://id.nii.ac.jp/1001/00199414/>なめらかなセキュリティを目指して</a>, 研究報告インターネットと運用技術（IOT）, Vol.2019-IOT-47, pp.1-7, Sep 2019. <a href=https://rand.pepabo.com/papers/iot47-miyakey.pdf>[論文]</a> <a href=https://speakerdeck.com/monochromegane/toward-the-coherently-fittable-security>[発表資料]</a></li><li>三宅 悠介, 松本 亮介, <a href=http://id.nii.ac.jp/1001/00195696/>利用者の文脈に応じて継続的に推薦手法の選択を最適化する推薦システム</a>, 研究報告インターネットと運用技術（IOT）, Vol.2019-IOT-45, pp.1-7, May 2019. <a href=https://rand.pepabo.com/papers/iot45-miyakey.pdf>[論文]</a> <a href=https://speakerdeck.com/monochromegane/iot45-synapse>[発表資料]</a></li></ol><h2 id=国外発表>国外発表</h2><p>初の海外カンファレンス登壇。めでたい！</p><ul><li>Yusuke Miyake, <a href=https://www.gophercon.com/agenda/session/49010>Optimization for Number of goroutines Using Feedback Control</a>, <a href=https://www.gophercon.com/>GopherCon Marriott Marquis San Diego Marina, California</a>, July 2019. [<a href=https://speakerdeck.com/monochromegane/optimization-for-number-of-goroutines-using-feedback-control>資料</a>] [<a href=https://blog.monochromegane.com/blog/2019/07/25/gophercon_2019_kaburaya/>スピーカーノート</a>] [<a href=https://youtu.be/O_R7Nwsix1c>動画</a>]</li></ul><h2 id=国内発表>国内発表</h2><p>技術イベント、研究会での発表で計６回。</p><ol><li>三宅 悠介, <a href=https://speakerdeck.com/monochromegane/fukuokago14-flagen>コマンドラインオプションをパースするコードをコマンドラインオプションから生成するツールをつくった</a>, <a href=https://fukuokago.connpass.com/event/146447/>Fukuoka.go#14+Umeda.go</a>, 2019年10月.</li><li>三宅 悠介, <a href=https://blog.monochromegane.com/blog/2019/10/04/wsa5_kaburaya_autoscaler/>Kaburaya AutoScaler: 多環境での運用性を考慮した自律適応型オートスケーリング制御系</a>, <a href=https://websystemarchitecture.hatenablog.jp/entry/2019/07/30/172650>第五回 Webシステムアーキテクチャ研究会</a>, 2019年9月.</li><li>三宅 悠介, <a href=https://www.facebook.com/events/454332078445860/>「エンジニアコミュニティの運営について」パネルディスカッション</a>, <a href=https://www.facebook.com/events/454332078445860/>Engineer Friendly Space</a>, 2019年7月.</li><li>三宅 悠介, <a href=https://speakerdeck.com/monochromegane/pepacon-night-ai-wg>AI（機械学習）ワーキンググループ 成果報告</a>, <a href=https://pepabo.connpass.com/event/128486/>ペパコンナイト</a>, 2019年5月. <a href="https://youtu.be/KKxHu5o01zw?t=4420">[動画]</a></li><li>三宅 悠介, <a href=https://speakerdeck.com/monochromegane/wsa-4-ebira>Ebira: アクセス負荷に応じて継続的にスケーリング基準を最適化する汎用オートスケーリング機構</a>, <a href=https://websystemarchitecture.hatenablog.jp/entry/2019/02/26/100725>第四回 Webシステムアーキテクチャ研究会</a>, 2019年4月.</li><li>三宅 悠介, <a href=https://speakerdeck.com/monochromegane/understanding-go-language-server>Go language serverを理解する</a>, <a href=https://fukuokago.connpass.com/event/118377/>Go 1.12 Release Party in Fukuoka</a>, 2019年2月. <a href=https://crash.academy/video/722/2051>[動画]</a></li><li>三宅 悠介, <a href=https://speakerdeck.com/monochromegane/dragon-imports>dragon-importsで爆速goimports生活 - プロジェクト Go modules</a>, <a href=https://fukuokago.connpass.com/event/112073/>Fukuoka.go#13+Okayama.go</a>, 2019年2月.</li></ol><h2 id=oss>OSS</h2><p>Kaburayaを中心に自律適応的な仕組みに向けての知見を深めていった。また、研究系のシミュレーションが増えてきた。</p><ul><li><a href=https://github.com/monochromegane/kaburaya>Kaburaya</a>: Kaburaya optimize the number of goroutines by feedback control.</li><li><a href=https://github.com/monochromegane/queuing-theory-simulator>queuing-theory-simulator</a>: Queuing theory simulator in Go.</li><li><a href=https://github.com/monochromegane/kaburaya-autoscaler>Kaburaya AutoScaler</a>: An autoscaler controller based on queuing theory.</li><li><a href=https://github.com/monochromegane/flagen>flagen</a>: A command line option parser generator using command line option.</li></ul><h2 id=コミュニティ活動>コミュニティ活動</h2><p>Goを中心に精力的に活動できた。特に全国規模のカンファレンスを福岡で主催したり、地方のGoコミュニティ同士を繋いだり福岡以外へも活動の幅が広がっている。
また、OSS GateやFukuoka.LTへの参加を通して福岡全体の盛り上げにも協力できたかなと思う。</p><ul><li><a href=https://fukuokago.connpass.com/event/112073/>Fukuoka.go#13+Okayama.go</a></li><li><a href=https://fukuokago.connpass.com/event/118377/>Go 1.12 Release Party in Fukuoka</a></li><li><a href=https://oss-gate-fukuoka.connpass.com/event/121702/>OSS Gate Fukuoka - 2 commits -</a></li><li><a href=https://fukuokago.connpass.com/event/130797/>Go Conference&rsquo;19 Summer in Fukuoka</a></li><li><a href=https://fukuokago.connpass.com/event/139929/>Go 1.13 Release Party in Fukuoka /w Tokyo</a></li><li><a href=https://fukuokago.connpass.com/event/143986/>「はじめてのGo言語教室」〜晩夏の岩田プロ福岡出張スペシャル〜</a></li><li><a href=https://fukuokago.connpass.com/event/146447/>Fukuoka.go#14+Umeda.go</a></li><li><a href=https://fukuokago.connpass.com/event/155369/>Fukuoka.LT（福岡のいろんなコミュニティを集められるだけ集めて合同忘年LT大会）</a></li></ul><h2 id=出版物等への寄稿>出版物等への寄稿</h2><p>前作に引き続きガッツリと査読に関わらせていただいた。</p><ul><li>書籍査読: スマートニュース株式会社　立石 賢吾, やさしく学ぶ ディープラーニングがわかる数学のきほん ~アヤノ＆ミオと学ぶ ディープラーニングの理論と数学、実装~, マイナビ出版, 2019年07月31日. <a href="https://book.mynavi.jp/ec/products/detail/id=104970">ISBN：978-4-8399-6837-3</a></li></ul><h2 id=ブログ>ブログ</h2><p>13本。一時期は日記を書いていたが、考えをまとめる練習にはつながらなかったかもしれない。
実績に加えてどうしてそのような活動に至ったのかについてもトップダウンの視点で書いていきたい。</p><ul><li><a href=https://blog.monochromegane.com/blog/2019/11/27/guidepost_for_writing_paper/>論文執筆の道しるべ</a></li><li><a href=https://blog.monochromegane.com/blog/2019/10/25/fukuokago14_flagen/>コマンドラインオプションをパースするコードをコマンドラインオプションから生成するツールをつくった</a></li><li><a href=https://blog.monochromegane.com/blog/2019/10/11/random_number_gen_using_go/>待ち行列理論に使われる分布に従う乱数をGo言語で生成する</a></li><li><a href=https://blog.monochromegane.com/blog/2019/10/04/wsa5_kaburaya_autoscaler/>Kaburaya AutoScaler: 多環境での運用性を考慮した自律適応型オートスケーリング制御系</a></li><li><a href=https://blog.monochromegane.com/blog/2019/08/11/toward_the_oversea_conference/>初めて海外カンファレンス登壇するためにやったこと</a></li><li><a href=https://blog.monochromegane.com/blog/2019/08/10/gophercon_2019/>GopherCon 2019で初の海外カンファレンス登壇をしてきました</a></li><li><a href=https://blog.monochromegane.com/blog/2019/08/02/gocon_fukuoka/>福岡でGoConを開催した</a></li><li><a href=https://blog.monochromegane.com/blog/2019/07/25/gophercon_2019_kaburaya/>GopherCon 2019: Optimization for Number of goroutines Using Feedback Control</a></li><li><a href=https://blog.monochromegane.com/blog/2019/04/14/wsa_4_ebira/>Ebira: アクセス負荷に応じて継続的にスケーリング基準を最適化する汎用オートスケーリング機構</a></li><li><a href=https://blog.monochromegane.com/blog/2019/03/01/the-things-coherently-fittable-system-looks-ahead-to/>なめらかなシステムの見据えるもの。個人的考察</a></li><li><a href=https://blog.monochromegane.com/blog/2019/02/25/entrance-of-research/>わかるとわからないの間</a></li><li><a href=https://blog.monochromegane.com/blog/2019/02/23/remote-study-group/>拠点間勉強会を接続するリモート勉強会への誘い</a></li><li><a href=https://blog.monochromegane.com/blog/2019/01/17/oss-gate-as-supporter/>OSS Gateにサポーターとして参加した（東京・福岡）</a></li></ul></div><footer class=tag><i class="fa fa-tags tag-icon"></i><ul><li><a class=tag-link href=/tags/%E3%81%B5%E3%82%8A%E3%81%8B%E3%81%88%E3%82%8A>ふりかえり</a></li></ul><div class=clear></div></footer></div></article><article><div class=post><header><h1><a href=https://blog.monochromegane.com/blog/2019/11/27/guidepost_for_writing_paper/>論文執筆の道しるべ</a></h1><time><div class=day><i class="fa fa-calendar-o day-icon"></i>2019-11-27</div></time></header><div class=post-inner><p>論文執筆にあたり自分向けの指針のようなものがまとまってきたのでメモしておく。
以下の内容の一枚もののサマリがあると良いのではないか。</p><ol><li>背景: なぜその課題に取り組むか</li><li>リサーチクエスチョン: 何を解決したいのか</li><li>従来手法の整理: これまではその課題をどう解決していたのか、これまでのやり方に残った課題は何か</li><li>提案手法: 残った課題をどう解決したか</li><li>評価: 残った課題は定量的にどの程度解決したか</li></ol><p>ここで</p><ul><li>2.のリサーチクエスチョンと3.従来手法の課題を混同しない。</li><li>3.従来手法の課題、4.提案手法、5.評価はもれなく対応する。つまり、課題が3つであれば提案手法もそれらに対する解決アプローチを提示し、それぞれに評価が行われている。もしくは課題のうち、いくつを解決するものかを明示する。</li><li>これらは一枚まとめにすると良い。シーケンシャルな文章とこのまとめを交互に見直すことで道筋を外れずに具体と抽象を行き来できる（といいな）</li></ul><p>上手な査読者のレビューは提案内容を除けば上記の観点での過不足を指摘しているように思える。
指摘事項に対する個別対処では、論文執筆力の向上はのぞめないのでこのような枠組みも意識して一定の水準での論文を執筆できるようにもなっていきたい。</p><p>また、議論から多くを得るためには</p><ul><li>分野のやや異なる人とは1.背景の説明を長めに取ることで自分の思い込みや暗黙の前提が浮き彫りにされ読み易い論文になる</li><li>分野の同じ人とは同じ課題意識を持つとみなし、従来手法の整理と提案手法のアプローチを中心に議論する</li><li>差読者目線を持つ人とは、リサーチクエスチョンを一言で伝わるか、それが解決したかをできるだけ手短に説明する</li></ul><p>のような感じに使い分けると良いのではないかなと考えている。</p></div><footer class=tag><i class="fa fa-tags tag-icon"></i><ul><li><a class=tag-link href=/tags/%E8%AB%96%E6%96%87>論文</a></li></ul><div class=clear></div></footer></div></article><article><div class=post><header><h1><a href=https://blog.monochromegane.com/blog/2019/10/25/fukuokago14_flagen/>コマンドラインオプションをパースするコードをコマンドラインオプションから生成するツールをつくった</a></h1><time><div class=day><i class="fa fa-calendar-o day-icon"></i>2019-10-25</div></time></header><div class=post-inner><p>コマンドラインオプションの形式は決まったけれども、パース処理を実装するために各言語やライブラリのドキュメントを読むことを繰り返していたので、この手間を省くためのツールをつくりました。</p><iframe src="//hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Fmonochromegane%2Fflagen" title=monochromegane/flagen class="embed-card embed-webcard" scrolling=no frame border=0 style="width:100%;height:155px;max-width:500px;margin:10px 0">&lt;a href="https://github.com/monochromegane/flagen"&gt;monochromegane/flagen&lt;/a&gt;</iframe><p>flagenは、先に決めたコマンドラインオプションから、これを解析するための各言語用のコードを出力するツールです。
オプション名から変数名や変数の型、デフォルト値が決定されるため、汎用的なボイラーテンプレートと比較して編集の手間が少なくなります。
また、テンプレートによって任意の出力を行えるため、エディタや自前のボイラーテンプレート出力ツールとの連携が容易です。
使いやすくするため、プリセットのテンプレートとしてGo、Ruby、Python、Shellのものを提供しています。</p><h1 id=使い方>使い方</h1><p>使い方は、テンプレートと実際に使う時のコマンドラインオプションを渡すだけです。</p><pre><code class=language-sh>$ flagen YOUR_TEMPLATE YOUR_COMMAND_LINE_OPTIONS...
</code></pre><p>例えば、</p><pre><code class=language-sh>$ flagen go --dist erlang -e k/l --lambda 1.5 -k 1 -v
</code></pre><p>と指定すると、Go用のコマンドラインオプションの解析処理を出力します。</p><pre><code class=language-go>var (
	dist	string
	e	string
	lambda	float64
	k	int
	v	bool
)

func init() {
	flag.StringVar(&amp;dist, &quot;dist&quot;, &quot;erlang&quot;, &quot;usage of dist&quot;)
	flag.StringVar(&amp;e, &quot;e&quot;, &quot;k/l&quot;, &quot;usage of e&quot;)
	flag.Float64Var(&amp;lambda, &quot;lambda&quot;, 1.5, &quot;usage of lambda&quot;)
	flag.IntVar(&amp;k, &quot;k&quot;, 1, &quot;usage of k&quot;)
	flag.BoolVar(&amp;v, &quot;v&quot;, false, &quot;usage of v&quot;)
}
</code></pre><p>指定されたコマンドラインオプションから変数名、オプション名、型、デフォルト値が設定されることで編集の手間が極力ない状態になっています。</p><p>Python、Ruby、Shellの例は<a href=https://godoc.org/github.com/monochromegane/flagen#pkg-examples>GodocのExamples</a>を参考にしてください。</p><h1 id=テンプレート>テンプレート</h1><p>テンプレートはGoの<a href=https://golang.org/pkg/text/template/>text/template</a>を利用して解析されます。
テンプレート内では、<code>.Flags</code>（解析したオプションの情報）と<code>.Args</code>（残りのコマンドライン引数）が利用可能です。
<code>.Flags</code>は<code>Name</code>と<code>Value</code>をもち、<code>Value</code>は更に<code>Type</code>と<code>Get</code>をもちます。</p><p>以下は、解析したオプションの情報を列挙するシンプルなテンプレート(my.tmpl)です。</p><pre><code>{{ range $flag := .Flags -}}
  {{ $flag.Name }}={{ $flag.Value.Get}}({{ $flag.Value.Type }})
{{ end }}
</code></pre><pre><code class=language-sh>$ flagen my.tmpl --dist erlang -e k/l --lambda 1.5 -k 1 -v
</code></pre><p>このテンプレートから以下の出力を得ることができます</p><pre><code>dist=erlang(string)
e=k/l(string)
lambda=1.5(float)
k=1(int)
v=false(bool)
</code></pre><p>また、テンプレート内では文字列のケース変換のための関数を利用することができます。
主に変数を言語の命名規約に合わせるのに使えます。
使える関数は、<a href=https://godoc.org/github.com/monochromegane/flagen#pkg-variables>こちら</a> で確認ください。</p><h1 id=連携>連携</h1><h2 id=vim>Vim</h2><p>flagenの結果は標準出力を使っているため、エディタとの連携も容易です。
例えば、Vimでは以下により、カーソル位置に結果を挿入することができます。</p><pre><code>:r!flagen YOUR_TEMPLATE YOUR_COMMAND_LINE_OPTIONS...
</code></pre><h2 id=ボイラーテンプレート出力ツール>ボイラーテンプレート出力ツール</h2><p>flagenはライブラリとして利用することができるため、自前のボイラーテンプレート出力ツールがGo製であれば以下のように呼び出すことができます。</p><pre><code class=language-go>	tmpl, err := flagen.NewTemplate(args[0])
	if err != nil {
		return err
	}
	return tmpl.Execute(outStream, args[1:])
</code></pre><p>また、独自の関数が必要な場合は <code>flagen.TemplateFuncMap</code>に設定することでテンプレート内で利用することができます。</p><h1 id=ワークアラウンド>ワークアラウンド</h1><h2 id=曖昧なフラグ>曖昧なフラグ</h2><p>flagenはオプションに値が指定されていないときにboolだと見なすため、以下のようにboolフラグで終わって引数がある場合に判断がつきません。</p><pre><code class=language-sh>$ flagen TEMPLATE --bool-flag arg1
</code></pre><p>想定どおりにするためには値としてtrue or falseを受け取ることを明示する必要があります。</p><pre><code class=language-sh>$ flagen TEMPLATE --bool-flag=false arg1
</code></pre><h1 id=まとめ>まとめ</h1><p>様々な実装が提供されているコマンドラインオプションの解析処理を利用形式から動的に生成するジェネレーターとしてflagenをつくりました。実際にいくつかの言語のテンプレートを用意してエディタと連携させることでCLI開発の効率が改善しています。</p><p>今後はflagen自体のオプションとしてprefixなどを提供すれば構造体の変数に設定する用途などのテンプレートとの相性もよくなりそうだと考えています。
便利なテンプレート追加のプルリクエストやイシュー、ボイラーテンプレートのツールへ組み込んだ報告などお待ちしています。</p><h1 id=fukuoka-go>Fukuoka.go</h1><p>このツールは<a href=https://fukuokago.connpass.com/event/146447/>Fukuoka.go#14+Umeda.go</a>で発表しました。
発表資料はこちらです。</p><script async class=speakerdeck-embed data-id=ece61cadb91e46febd8b692e32a8679f data-ratio=1.77777777777778 src=//speakerdeck.com/assets/embed.js></script></div><footer class=tag><i class="fa fa-tags tag-icon"></i><ul><li><a class=tag-link href=/tags/golang>golang</a></li></ul><div class=clear></div></footer></div></article><article><div class=post><header><h1><a href=https://blog.monochromegane.com/blog/2019/10/11/random_number_gen_using_go/>待ち行列理論に使われる分布に従う乱数をGo言語で生成する</a></h1><time><div class=day><i class="fa fa-calendar-o day-icon"></i>2019-10-11</div></time></header><div class=post-inner><p>待ち行列理論をシミュレーションする際にいくつかの分布に従う乱数を生成する必要があったのでメモ．
また，確率まわりの用語と分布についても理解が曖昧な点があったのでこの機会にまとめておく．</p><h1 id=用語の整理>用語の整理</h1><h2 id=確率>確率</h2><p>確率は，</p><p>\[
\frac{ある事象の起こる場合の数}{全ての事象の起こる場合の数}
\]</p><p>で求められる．</p><h2 id=確率変数>確率変数</h2><p>確率変数は，事象に対応した実数のこと．
確率変数には，離散型と連続型の二種類がある．
サイコロの出目のようなものは離散型で，身長や体重のような（原理的には）連続の値になるものは連続型．</p><h2 id=確率分布>確率分布</h2><p>確率分布は確率と確率変数との対応付け．
そもそも辞書的な意味での「分布」は「粗密の程度を含めた，空間的な広がり具合」を表す．
度数分布では階級と度数（階級に含まれる変量の数）の対応付けであった．
また，これらの分布は，度数分布と同様に確率分布表や確率分布グラフとして表すことができる．</p><h2 id=確率を返す関数>確率を返す関数</h2><p>ここで，ある確率変数を入力に，対応する確率を出力する関数を考える．</p><h3 id=確率質量関数>確率質量関数</h3><p>離散型の確率変数であれば，確率分布表を照会し，対応する確率を得ることができる．
確率変数を入力に，対応する確率を出力する関数を確率質量関数（または確率関数）[1]と言い，サイコロの出目を確率変数$X$とした時に1が出る確率を$P(X=1)=\frac{1}{6}$のように書ける．
もちろん確率の総和は1である．</p><h3 id=確率密度関数>確率密度関数</h3><p>連続型の確率変数の場合は，ある一点の値を入力とすると対応する確率は常に0となる．
これは，ある範囲においても実数は無限個あるため，全事象が無限になることから，確率の定義より$\frac{1}{\infty}=0$となるためである．
このように連続型の確率変数からは直接的に確率を求めることができないので，この連続型の確率変数を対応する「何か」に変換する必要がある．
また，その「何か」は確率に変換できる必要がある．
確率の定義から，総和は1である．
また，連続型の確率変数であることから，和は積分で求めることになる．</p><p>連続型の確率変数をx軸に，この連続型の確率変数を対応する「何か」をy軸にプロットした時に，ある範囲の割合は該当範囲の定積分によって導くことができる．
そして，全体の積分が1で，その中のある範囲の定積分が，事象がその範囲に含まれる確率に従うような「何か」があれば，それを連続型の確率変数の確率に用いることができる．
そのような「何か」が存在するとき，「何か」は「確率密度」と呼ばれ，連続型の確率変数を入力とし，確率密度を出力する関数を「確率密度関数」と呼ばれる[2]．</p><p>このとき，確率密度関数$f(x)$に従う確率変数$X$が$(a \leqq X \leqq b)$となる確率は\[\int_a^b f(x) dx\]のように書ける．</p><p>確率密度は，その確率変数の相対的な発生のしやすさを表すに過ぎないので，部分的にy軸(確率密度関数の返す値)が1を超えても構わない（全体の面積として1になれば良い．例えば，確率密度関数が$f(x)=2x (0 \leqq X \leqq 1)$のときなど）．</p><h1 id=待ち行列理論で使う分布>待ち行列理論で使う分布</h1><p>待ち行列理論では待ち行列のモデルの構造を以下のようなケンドール記号を用いて記述する．</p><ul><li><code>X/Y/S(N)</code></li></ul><p>ここでXは到着過程の種類，Yはサービス過程の種類，Sは窓口数，Nは待ち行列の長さの制限数が入る．
過程の種類は以下の通り．</p><table><thead><tr><th>種類</th><th>説明</th><th>備考</th></tr></thead><tbody><tr><td>M</td><td>マルコフ過程</td><td>到着過程ならポアソン分布，サービス過程なら指数分布</td></tr><tr><td>D</td><td>確定分布</td><td>到着間隔やサービス時間が一定</td></tr><tr><td>G</td><td>一般の分布</td><td>平均値と分散が既知の任意の分布</td></tr><tr><td>$E_k$</td><td>アーラン分布</td><td>k個の指数分布の和の分布</td></tr></tbody></table><h2 id=ポアソン分布>ポアソン分布</h2><p>単位時間に平均$\lambda$回起きる事象が単位時間に$k$回発生する分布[3]．</p><p>平均が$\lambda$のポアソン分布を表す確率質量関数は\[P(X=k)=\frac{\lambda^{k}}{k!}\cdot e^{-\lambda}\]であり平均$E[X]$は$\lambda$となる．</p><h2 id=指数分布>指数分布</h2><p>平均$\theta$時間に一回発生する事象の発生間隔を表す分布[4]．</p><p>平均が$\theta$の指数分布を表す確率密度関数は\[f(x)=\frac{1}{\theta}e^{-\frac{x}{\theta}} (x \geqq 0)\]であり平均$E[X]$は$\theta$となる．</p><h3 id=待ち行列とマルコフ過程>待ち行列とマルコフ過程</h3><p>あるランダムに起きる事象を発生回数から見たのがポアソン分布，発生間隔(または時間)から見たのが指数関数とみなすことができる．
マルコフ過程は未来の挙動は過去の挙動とは無関係であるとする性質を持つ確率過程であり，これらの分布が適合するため利用されている．</p><p>単位時間に$\lambda$回到着するとした到着過程はポアソン分布が利用されるが，シミュレーションにおいては平均到着間隔を知りたい．
この場合は，$\frac{1}{\lambda}$を到着間隔とした指数分布で求めることができる（1時間に平均5人くる場合，平均1/5時間(12分)の間隔で到着する）．
つまり，$\theta=\frac{1}{\lambda}$として，確率密度関数は\[f(x)=\lambda e^{-\lambda x} (x \geqq 0)\]であり平均$E[X]$は$\frac{1}{\lambda}$となる．</p><p>なお，ポアソン分布と指数分布の関係の理解には[5]が参考になる．このサイトでは時刻$t$を導入したポアソン分布の累積分布関数から指数分布の確率密度関数を導いている．</p><h2 id=アーラン分布>アーラン分布</h2><p>まず，ガンマ分布は平均$\theta$時間に一回発生する事象（指数分布）が$k$回発生するまでの時間の分布[6]である．
ガンマ分布の$k=1$のとき，指数分布と等しく，$k$が整数の場合にアーラン分布と呼ばれる．</p><p>ガンマ分布を表す確率密度関数は\[\frac{1}{\Gamma(k)\theta^{k}}x^{k-1}e^{-x/\theta}\]であり平均$E[x]$は$k\theta$となる．</p><p>また，前述のポアソン分布のパラメタから指数分布の確率密度関数を求めたのと同様に，$\theta=\frac{1}{\lambda}$として，確率密度関数は\[\frac{\lambda^k}{\Gamma(k)}x^{k-1}e^{-\lambda x}\]であり平均$E[x]$は$\frac{k}{\lambda}$とも書ける．</p><p>ここまで，$k$回の$\theta=1/\lambda$の指数分布を場合を見てきたが，待ち行列理論の書籍においては，$k$回の$\frac{\theta}{k}=\frac{1}{k\lambda}$の指数分布としている場合がある．
すなわち，一つのサービス時間$\theta$が$k$個の工程（1工程あたり$\frac{\theta}{k}$）からなるとみなしている．
この場合，確率密度関数は\[\frac{(k\lambda)^k}{\Gamma(k)}x^{k-1}e^{-k\lambda x}\]であり平均$E[X]$は$\theta=1/\lambda$となる．</p><h1 id=待ち行列理論で使う分布に従う乱数>待ち行列理論で使う分布に従う乱数</h1><p>ここでは，ある分布に従う乱数をGoでの生成する．</p><h2 id=指数分布-1>指数分布</h2><p>指数分布に従う乱数はGoの標準パッケージ<a href=https://golang.org/pkg/math/rand/#Rand.ExpFloat64>math/randで提供</a>されている．</p><pre><code class=language-go>func Exponential(rnd *rand.Rand, lambda float64) float64 {
        return rnd.ExpFloat64() / lambda
}
</code></pre><p>パラメタ$\theta=1/\lambda$に合わせるためには結果を$\lambda$で割る（平均到着率が増えるほど平均到着間隔は狭くなる）．</p><p>動作確認のため，生成した乱数のヒストグラムと指数分布の確率密度関数を重ねてプロットした．</p><p><img src=/images/2019/10/hist_and_pdf_exponential.png alt=hist_and_pdf_exponential></p><h2 id=ポアソン分布-1>ポアソン分布</h2><p>ポアソン分布に従う乱数はGoの標準パッケージで提供されていない．
そこで指数分布とポアソン分布の関係性を利用して，指数分布で得られた乱数の和が1を超えるまでの最小のカウント数を用いる方法がある[7][8]．
例えば平均到着率($\lambda$)が5人であれば，平均到着間隔($1/\lambda=0.2$)である．
ここでカウントは$0.2*5$が平均して得られると考えられる．</p><pre><code class=language-go>func Poisson(rnd *rand.Rand, lambda float64) float64 {
        p := 0.0
        for i := 0; ; i++ {
                p += Exponential(rnd, lambda)
                if p &gt;= 1.0 {
                        return float64(i)
                }
        }
        return 0.0
}
</code></pre><p>生成した乱数のヒストグラムとポアソン分布の確率質量関数のプロット．</p><p><img src=/images/2019/10/hist_and_pmf_poisson.png alt=hist_and_pmf_poisson></p><h2 id=アーラン分布-1>アーラン分布</h2><p>アーラン分布もしくはガンマ分布に従う乱数はGoの標準パッケージで提供されていない．
しかし，ガンマ分布の定義（k個の指数分布の和の分布）[6]から以下の実装が可能である．</p><pre><code class=language-go>func ErlangKL(rnd *rand.Rand, lambda float64, k int) float64 {
        g := 0.0
        for i := 0; i &lt; k; i++ {
                g += Exponential(rnd, lambda)
        }
        return g
}
</code></pre><p>ここで，<code>KL</code>は平均が$\frac{k}{\lambda}$であることを表している．</p><p>生成した乱数のヒストグラムとアーラン分布の確率密度関数のプロット．</p><p><img src=/images/2019/10/hist_and_pdf_erlangkl.png alt=hist_and_pdf_erlangkl></p><p>待ち行列理論の参考書にあるようなサービス工程を$k$個に分割するアーラン分布では$k$回の$\frac{\theta}{k}=\frac{1}{k\lambda}$の指数分布となることから以下の実装となる．</p><pre><code class=language-go>func Erlang1L(rnd *rand.Rand, lambda float64, k int) float64 {
        g := 0.0
        for i := 0; i &lt; k; i++ {
                g += Exponential(rnd, float64(k)*lambda)
        }
        return g
}
</code></pre><p>ここで<code>1L</code>は平均が$\frac{1}{\lambda}$であることを表している．</p><p>生成した乱数のヒストグラムとアーラン分布の確率密度関数のプロット．</p><p><img src=/images/2019/10/hist_and_pdf_erlang1l.png alt=hist_and_pdf_erlang1l></p><h1 id=動作確認用のコード>動作確認用のコード</h1><p>動作確認用のコードは以下にある．</p><ul><li><a href=https://gist.github.com/monochromegane/be5b872b3aa71d1a314a8b8bb74be60b>main.go</a></li><li><a href=https://gist.github.com/monochromegane/13123f681db5cf376e79b854cfdec5ba>plot.py</a></li></ul><p>このような感じで利用できる．</p><pre><code class=language-sh>go run main.go -size 100000 -dist erlang -e k/l -lambda 0.5 -k 2 &gt; data.txt &amp;&amp; python plot.py --dist erlang -e k/l --lambda 0.5 -k 2
</code></pre><h1 id=参考>参考</h1><ul><li>[1] <a href=https://ja.wikipedia.org/wiki/%E7%A2%BA%E7%8E%87%E8%B3%AA%E9%87%8F%E9%96%A2%E6%95%B0>確率質量関数 - Wikipedia</a></li><li>[2] <a href=https://ja.wikipedia.org/wiki/%E7%A2%BA%E7%8E%87%E5%AF%86%E5%BA%A6%E9%96%A2%E6%95%B0>確率密度関数 - Wikipedia</a></li><li>[3] <a href=https://ja.wikipedia.org/wiki/%E3%83%9D%E3%82%A2%E3%82%BD%E3%83%B3%E5%88%86%E5%B8%83>ポアソン分布 - Wikipedia</a></li><li>[4] <a href=https://ja.wikipedia.org/wiki/%E6%8C%87%E6%95%B0%E5%88%86%E5%B8%83>指数分布 - Wikipedia</a></li><li>[5] <a href=http://www.f-denshi.com/000TokiwaJPN/17kakto/100prob.html>ときわ台学/統計学/ポアソン分布と指数分布</a></li><li>[6] <a href=https://ja.wikipedia.org/wiki/%E3%82%AC%E3%83%B3%E3%83%9E%E5%88%86%E5%B8%83>ガンマ分布 - Wikipedia</a></li><li>[7] <a href=https://www.ishikawa-lab.com/montecarlo/4shou.html>どんな分布の乱数でも作り出せる</a></li><li>[8] <a href=https://nineties.github.io/math-seminar/14.html>擬似乱数の生成法・推定 - プログラマの為の数学勉強会</a></li></ul></div><footer class=tag><i class="fa fa-tags tag-icon"></i><ul><li><a class=tag-link href=/tags/golang>golang</a></li></ul><div class=clear></div></footer></div></article><article><div class=post><header><h1><a href=https://blog.monochromegane.com/blog/2019/10/04/wsa5_kaburaya_autoscaler/>Kaburaya AutoScaler: 多環境での運用性を考慮した自律適応型オートスケーリング制御系</a></h1><time><div class=day><i class="fa fa-calendar-o day-icon"></i>2019-10-04</div></time></header><div class=post-inner><p>このエントリは、<a href=https://websystemarchitecture.hatenablog.jp/entry/2019/07/30/172650>第五回 Web System Architecture 研究会 (WSA研)</a>の予稿です。</p><h1 id=はじめに>はじめに</h1><p>Webサービスの運用において，急激なアクセス頻度の上昇に対する安定性を保つため，Webアプリケーションにスケーラビリティの仕組みが一般的に求められるようになった．
これを支援するためにWebアプリケーションを稼働させるクラウドサービスやオーケストレーションツールから，オートスケーリング機能が提供されている．
これらのオートスケーリング機能では，開発運用者が予め定めた条件を元にWebアプリケーションの状況が監視される．
そうして，条件を満たせば，開発運用者が予め定めたスケール方法とその実施量に従いWebアプリケーションをスケールさせる．</p><p>このようにオートスケーリングによって，ユーザからのリクエスト数の増減に応じて最適なサーバ台数を調整されることで利用者の快適さと情報システムの運用コストを両立できるようになった．
一方で，オートスケーリングを導入し，継続的に安定した運用するためには開発運用者の運用努力が必要であるが，これらは管理する環境の増加に従い困難になる．
そのため，多環境での運用性を考慮した自動化可能なオートスケーリング戦略が求められる．</p><p>オートスケーリングの継続的に安定した運用に向けた課題は大きく二つある．
一つ目は，アプリケーション特性の把握，二つ目は，“遅れ”の考慮である．</p><h2 id=課題1-アプリケーション特性の把握>課題1: アプリケーション特性の把握</h2><p>スケールにはWebアプリケーションを稼働する仮想サーバへリソースを追加する垂直スケール（スケールアップ），稼働する仮想サーバを追加する水平スケール（スケールアウト）の2種類の方法がある．
しかしながら，どちらの方法を用いるにせよ，開発運用者はWebアプリケーションの特性に応じたオートスケーリングの条件やその実施量を予め定める必要がある．
例えば，時刻ベースであればアクセス頻度の時系列的傾向や，リソース変動ベースであればボトルネックとなるメトリクスである．
また，これらの条件に対する必要台数の算出も必要となる．
Webアプリケーションは常に変更が加わることから，手動での継続的な特性の把握と決定は運用負荷の面で現実的ではない．</p><p>そこで，特性把握の自動化が行われている．
三宅らは，過去のアクセス頻度のデータからLSTMを用いて24時間先までの1時間単位のアクセス頻度を予測するモデルを構築し，予測アクセス頻度を元に経験から得られたサーバ単位のスループットにより必要なサーバ台数を求めた[1]．
スループットの把握では，パラメタを連続的に変化させながら最良の結果を得る値を探索的に求める方法も提案されている[2]．
これらの予測的，探索的なアプローチによる特性把握の自動化により，変化する環境に対する追従性は向上する．
一方で，事前的なアプローチであるため，予測の誤差，探索を行った環境と本番環境の誤差に対処できないという課題が残る．</p><p>そのため，三宅らはフィードバック制御による個別の特性把握を必要としないアプローチ[3][4]を提案した．
この手法では，直近のレスポンスタイムが均衡する点に収束するような台数調整によって特性把握が不要で実行時に誤差を修正することができる．
ただし，フィードバック制御を用いるため，制御量であるサーバ台数の決定は探索的である．
待ち行列理論によれば窓口利用率が1を超えると待ち行列は収束しないとされていることから，サーバ台数は即時かつ決定的に求められることが望ましい．</p><h2 id=課題2-遅れ-の考慮>課題2: “遅れ”の考慮</h2><p>オートスケーリングでは，本番環境の誤差に対応するための即応的なアプローチを採用すると&rdquo;遅れ&rdquo;の課題が発生する．
一つ目の遅れは，負荷上昇からサーバ台数を見積もるまでの時間差である．
本稿ではこれを「入力の遅れ」と呼ぶ．
次はサーバ台数の変更指示から起動までの時間差である．
本稿ではこれを「出力の遅れ」と呼ぶ．
待ち行列理論によれば窓口利用率が1を超えると待ち行列は収束しないとされていることから，これらの遅れに対して発生した待ちリクエストが系の安定性を崩す．
安定性の低下は開発運用者による不定期な対応を要請し，運用負荷につながることからこれを回避する必要がある．</p><p>そのために，遅れを最小化する手法が適用される．
入力の遅れでは，変化点検出などにより負荷上昇を即時に察知する方式がある．
また，出力の遅れではCRIUを利用することで起動までの時間を短縮する方式[5]がある．
しかしながら，精度の観点やシステム制約によって遅れを0にはできないため，遅れそのものに対する対策は必要となる．</p><p>遅れを踏まえた準備では，前述の予測的なアプローチが考えられる．
三宅らの手法[1]では，予測と事前起動によりこれらの遅れを考慮するが，本番環境の誤差への課題が残る．
そこで，スミスの予測法[6]のようにフィードバック制御において遅れによる影響を踏まえた制御量を算出する手法がある．
一方で，予測のためには精度の高い予測モデルの構築が必要であり，追従にはここの自動化が必須となる．</p><h1 id=提案手法>提案手法</h1><p>多環境での運用性を考慮したアプリケーション特性の把握の自動化と安定性の両立のためには，以下の要件が必要となる．</p><ol><li>Webアプリケーション特性として負荷に対する実施量の関係が把握できる</li><li>これを不必要な負荷をかけることなく実行時に自動で把握できる</li><li>把握したWebアプリケーション特性と実環境に誤差が生じた場合に修正できる</li><li>これを実現するリアクティブなアプローチで発生する”遅れ”へ対処できる</li></ol><p>そこで，フィードフォワード制御を中心とし，実環境の特性把握・追従のためにフィードバック制御を組み込んだ2自由度のオートスケーリング制御系を提案する．
提案手法により，特性把握・追従の自動化ならびに待ち行列理論を用いた決定的な台数算出・遅れ補償による安定化が見込める．
なお，本提案手法の実装はKaburaya AutoScalerとして，OSSでの公開・開発を続けている．</p><ul><li><a href=https://github.com/monochromegane/kaburaya-autoscaler>monochromegane/kaburaya-autoscaler</a></li></ul><p>提案手法では，Webアプリケーション特性を求めるにあたって低負荷時では理想的なレスポンスタイム，高負荷時ではスループット限界を用いることで対象のWebアプリケーションに不必要な負荷をかけることなく現状に即したWebアプリケーション特性を把握することができる．
また，仮想サーバ起動までの遅れに伴う負荷状況を予測し，これを見越した実施量を見積もる遅れ補償機構を設けた．</p><p>提案手法のアーキテクチャを以下に示す．</p><p><img src=https://user-images.githubusercontent.com/1845486/65784527-35289080-e18d-11e9-98eb-a155ed8967cc.png alt="Kaburaya AutoScaler Architecture"></p><p>ここで$F$はフィードフォワード制御部である． 現状の負荷状況に応じて実施量であるサーバ台数を算出する．
算出には待ち行列理論の窓口利用率を求める式を変形した$\lambda/\rho\mu$を用いる．
なお，$\lambda$は平均到着率（req/単位時間），$\mu$は平均サービス率（req/単位時間），$\rho$は窓口利用率を表す．
提案手法では$\rho$には0より大きく1未満の任意の値を設定することができる．</p><p>$P$はプラントであり，$F$で求めたサーバ台数を用いて実際にWebサービスを運用する実環境である．
提案手法では実環境の計測誤差をフィードバックすることで自動かつ継続的な安定性を保つ． $P$は計測結果として単位時間での平均レスポンスタイムである$T_s$と単位時間での1台あたりの処理数である$\mu$を返却する．
これらの値は，$F$における新しい$\mu$に用いられる．</p><p>提案手法では仮想サーバ起動までの遅れに伴う負荷状況を予測し，これを見越した実施量を見積もる遅れ補償機構を設けた．
待ち行列理論では無限時間の平均した待ち時間を求めるため，窓口利用率が1以上の場合に発散し，理論を適用することができない．
一方で，遅れ時間は有限であることから，窓口利用率が1以上の場合であっても待ち行列の長さを求めることができると考えた．
そこで$(\lambda^{t-1}-s^{t-1}\mu^{t-1})\gamma$のように不足処理能力による待ち行列の長さとて加えて，これを捌くことができるサーバ台数を求めている．</p><h1 id=評価>評価</h1><p>プラントのシミュレータを使って提案手法によるオートスケーリングの自律・適応の性能を評価した．</p><p><img src=https://user-images.githubusercontent.com/1845486/65784472-16c29500-e18d-11e9-9fee-718bac3bbdbd.png alt=Evaluation></p><p>右下のグラフにより$\mu$の推定・追従が行えていること，左上のグラフにより遅れ補償が働きアクセス増加時に一時的に多いサーバを投入することで収束できていることが確認できる．
個別の評価についてはスライドを参照されたい．</p><h1 id=発表スライド>発表スライド</h1><script async class=speakerdeck-embed data-id=f71a76ce6cbf454ab583d968916df2b8 data-ratio=1.77777777777778 src=//speakerdeck.com/assets/embed.js></script><h1 id=まとめ>まとめ</h1><p>本研究会ではオートスケーリングと開発運用者間の関係をなめらかにするための多環境での運用を考慮した自律適応型オートスケーリング制御系を提案した．
評価ではM/M/Sモデルを前提としたプラントシミュレータによってこれらが達成可能なことを示した．
実用化に向けて今後はプラントに実際のWebサーバ/アプリケーションサーバを適用した評価や実際の到着，サービス時間間隔に近い分布での評価が必要である．
また，提案手法では入力の遅れに伴い単位時間内に待ちリクエストが必ず発生するため変化点検出などで遅れ時間自体を短縮する方式も検討したい．</p><h1 id=発表を終えて>発表を終えて</h1><p>今回のWSA研究会もとても面白かった．
Webシステムアーキテクチャという題材で色々な分野の人が集まって議論することで持ち寄ったアイディアが前進して行くのを何度も見ている．
自分自身の取り組みも研究としてWSA#3からWSA#4を通してGopherConで登壇できるぐらいに育った．
加えて，今回は，オートスケーリングの課題に着目して新しいアプローチを試してみる中で，制御工学や待ち行列理論などを学び楽しめた．
このような普段の研究から少し離れた取り組みであっても，定期的に発表を促されることで形にすることができるのはとても大切で，やりっぱなし学びっぱなしではなく一つの区切りまで考え実装することで次回以降の研究への糧となる．
Webシステムアーキテクチャに関する運用知見を研究的アプローチで前進させること興味がある方は次回開催の参加を検討してみてはいかがでしょうか．</p><ul><li><a href=https://websystemarchitecture.hatenablog.jp/entry/2017/11/16/182041>Web System Architecture研究会の発足と挨拶</a></li><li><a href=https://websystemarchitecture.hatenablog.jp/purpose>研究会の目的</a></li></ul><h1 id=リファレンス>リファレンス</h1><ul><li>[1]: 三宅 悠介, 松本 亮介, 力武 健次, 栗林 健太郎, アクセス頻度予測に基づく仮想サーバの計画的オートスケーリング, FIT 2018 第17回情報科学技術フォーラム, CL-002, Sep 2018.</li><li>[2]: 全自動パラメータチューニングさん <a href=https://blog.mirakui.com/entry/2013/02/20/003401>https://blog.mirakui.com/entry/2013/02/20/003401</a></li><li>[3]: Yusuke Miyake, Optimization for Number of goroutines Using Feedback Control, GopherCon Marriott Marquis San Diego Marina, California, July 2019.</li><li>[4]: 三宅 悠介, Ebira: アクセス負荷に応じて継続的にスケーリング基準を最適化する汎用オートスケーリング機構, 第四回 Webシステムアーキテクチャ研究会, 2019年4月.</li><li>[5]: 松本 亮介, 近藤 宇智朗, CRIUを利用したHTTPリクエスト単位でコンテナを再配置できる低コストで高速なスケジューリング手法, 研究報告インターネットと運用技術（IOT）, Vol.2019-IOT-44, pp.1-8, Feb 2019.</li><li>[6]: O. Smith, &ldquo;Closer control of loops with dead time&rdquo;, Chemical engineering progress, Vol. 53, No. 5, pp. 217-219, 1957.</li></ul></div><footer class=tag><i class="fa fa-tags tag-icon"></i><ul><li><a class=tag-link href=/tags/wsa%E7%A0%94>WSA研</a></li></ul><div class=clear></div></footer></div></article><article><div class=post><header><h1><a href=https://blog.monochromegane.com/blog/2019/08/11/toward_the_oversea_conference/>初めて海外カンファレンス登壇するためにやったこと</a></h1><time><div class=day><i class="fa fa-calendar-o day-icon"></i>2019-08-11</div></time></header><div class=post-inner><p>7/24から27にかけてアメリカ、サンディエゴで開催されたGopherCon 2019で人生初となる海外カンファレンスに登壇してきました（発表の様子は<a href=https://blog.monochromegane.com/blog/2019/08/10/gophercon_2019/>こちら</a>にまとめました）。
GopherConはGo関連で最大級の国際カンファレンスです。
6年目となる今年は世界中から1,800名のGopherが参加し、200名以上の応募の中から選ばれた36名がスピーカーとして登壇しました。
その中で、僕は「Optimization for Number of goroutines Using Feedback Control」というタイトルで45分の<a href=https://www.gophercon.com/agenda/speakers/442434>チュートリアルセッション</a>を務めました。</p><p>これまで海外カンファレンス登壇経験はなく、英語にも不慣れであるものの、現在の自分にとって非常に重要な位置付けのイベントであり、1月のCfPから7月の発表に至るまでの長丁場を非常に高い優先度で取り組んできました。
これらの取り組みについて、自分自身の次の登壇への振り返りとして、何より今後、僕と同じように海外カンファレンス登壇を目指す方にとって何かしら参考になればと思いまとめておきます。</p><h1 id=採択に向けて>採択に向けて</h1><h2 id=投稿のネタを育てておく>投稿のネタを育てておく</h2><p>まずは話すネタがなければ投稿できません。
普段の業務やOSS活動で得た生の経験や実績は、頭の中にあるだけではやがて自分にとって当たり前になり輝きを失っていきます。
そのため、普段から忘れないように登壇ネタとしてメモしておくだけでも有効です。
ただ、実際には、ブログや国内の勉強会での登壇などを通して、カタチを与えて上げておくと良いと思います。
このアウトプット作業に暗黙的に含まれる他人に伝えるという制約によって、ただの経験が洗練されてよそゆきの顔になっていくからです。
つまり、曖昧だったり複雑な部分を解きほぐし自分の理解が深まることで提案や動機付けに対する説得力が生まれます。</p><p>今回の僕のネタは、幸いにもこの機会に恵まれました。
関連研究も含めるとWSA研究会とGoCon東京の計3回の発表とフィードバックを通して（現在進行形で）育てています。</p><h2 id=投稿のネタを選ぶ>投稿のネタを選ぶ</h2><p>どのようなネタであってもぜひ挑戦させてあげてください。
採択される可能性が限りなく高いネタはあっても絶対に通るネタはないのではないかなと思います。
なぜならカンファレンスの特徴や査読者のバックグラウンド、他の発表とのバランスなど採択には色々なパラメタも影響するからです。
なので、僕は<a href=https://twitter.com/tenntenn>@tenntenn</a>さんのこのスタンスで良いと思います。</p><p><blockquote class=twitter-tweet><p lang=ja dir=ltr>CfPに応募する時の1番の秘訣は自分で諦めないこと。自分って案外自分に厳しいので、このレベルじゃ駄目でしょと決めつけがち。選ぶのは自分じゃないし、落ちてもデメリットないので応募するのが一番得。</p>&mdash; tenntennʕ ◔ϖ◔ʔ ==Go (@tenntenn) <a href="https://twitter.com/tenntenn/status/1113254427488509954?ref_src=twsrc%5Etfw">April 3, 2019</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script></p><p>提出することで査読者からのフィードバックがもらえることもありますし、カンファレンス登壇に興味があればまずは応募してみましょう&hellip;!</p><p>ただし、発表実現性が著しく低いものは避けましょう。
発表までに実装や評価は間に合いますか？（採択されたら当日までにやることは他にもたくさんあります）
プロポーザルを書くコスト、査読するコストは発表実現性が高いものへ。</p><h2 id=プロポーザルの書き方を学ぶ>プロポーザルの書き方を学ぶ</h2><p>いかにして提案を査読者にアピールするかは重要であり難しい取り組みです。
ただし、査読者が求める事項は一般に共通しており、それゆえにベストプラクティスはあります。
今回、僕は@tenntennさんから教えてもらった以下のサイトに目を通してプロポーザル執筆に臨みました。</p><ul><li><a href=https://carolynvanslyck.com/blog/2018/12/talk-at-gophercon/>Submit a Talk to GopherCon!</a></li><li><a href=https://medium.com/@fox/how-to-write-a-successful-conference-proposal-4461509d3e32>How to write a successful conference proposal</a></li><li><a href=https://dave.cheney.net/2017/02/12/how-to-write-a-successful-conference-proposal>How to write a successful conference proposal (by Dave Cheney)</a></li><li><a href=http://russolsen.com/articles/2012/06/21/acing-the-technical-talk-getting-your-proposal-through-the-door.html>Talking Tech: Getting Your Proposal Through the Door</a></li><li><a href=https://blog.builderscon.io/entry/2017/05/09/090000>おすすめなカンファレンス用プロポーザルの書き方</a></li></ul><p>もちろん対象のカンファレンスの選考基準も目を通します。</p><blockquote><p>The selection criteria:</p><ol><li>Relevance. The talk is relevant to the Go community. GopherCon is not a general software conference, our audience wants to hear about topics that relate to the Go programming language.</li><li>Clarity. You’ve clearly explained what you are going to talk about.</li><li>Correctness. You’ve demonstrated knowledge of your topic. You don’t have to be an expert, but you are expected to be speaking from experience.</li><li>Achievability. You’ve thought about how to present your material in the time available.</li><li>Impact. The goal of the talk. What new idea, technique, tool, or information will the audience leave your presentation with?</li></ol></blockquote><p>僕はこの辺の書き方は論文執筆と同じだなあという感想を持ちました。
つまり、提案の新規性、有用性、信頼性などをわかりやすい構成で伝える技術です。
一方で、上で引用したGopherConの選考基準では、「専門家である必要はないが経験から語ることが期待される」と言う文言がありました。
これは一般論で終わらないことを伝えていると捉えられますが、やったことをそのまま出せばいいというわけでもないはずです。
つまり、経験から得られたものを一般化したり、潜在的な課題へと結びつけて、より多くの人に何かを持ち帰ってもらえるように思考することが求められます。
そういう意味ではやはり論文執筆に通じるものを感じます。</p><p>ただ、先の選考基準は「自分で」敷居を上げすぎるなという側面もあるとは思っていて、まずやったことを書く、それから上記を意識しながら少しづつ改善していくことが大切なのだろうと思います。</p><h2 id=プロポーザルを書く>プロポーザルを書く</h2><p>プロポーザルの書き方に従い、選んだネタを使ってプロポーザルを書きます。
英語に慣れていない場合はまず日本語で書くと良いと思います。
問題をわかりやすく整理して、可読性の高い構成にするのは難しい仕事なので、日本語で作って英語にする方が結果的に時間的・品質的に満足できるからです。</p><p>提案型の場合、汎用的には以下のような流れで文字数制限に応じて分量を調整していけると思います。</p><ul><li>1. 現状（現状における問題の定義。つまり理想状態との差）</li><li>2. 背景（定義した問題に対する従来のアプローチの整理。それらのアプローチの持つ課題を&rdquo;自分なりに&rdquo;整理）</li><li>3. 提案（その課題を解決する方法を提案）</li><li>4. 評価（提案手法の有効性を評価する方法、あれば結果を含める）</li></ul><p>従来ツールによる解決であれば、3はそのツールの紹介に、4は導入事例になります。
いずれにせよ、このようにしておくと各ステップの検討事項が分離できるので順番に議論すれば後戻りが発生しません。
つまり査読者の思考の流れを妨げません。
理想状態を念頭に、解決したい本当の問題と、従来アプローチの制約事項をうまく分離してあげるように考えるのがコツでしょうか。
これは難しいので投稿ネタを育てる工程で意識しながら繰り返しやっておくと良いと思います。
なお、論文だと理想状態がなぜ理想なのかの説明も求められるので大変ですが、エンジニア系のカンファレンスだとコンテキストが共有できているのでそこに文字数を割かなくても大丈夫です。
また、エレベータピッチなどの極端に文字数が少ない場合は、1の理想と2の整理した課題だけを述べて3に繋げています（4は含めない）</p><p>参考までに、僕が今回提出したプロポーザルを下記に置いておきます。
タイムテーブルのセクションは@tenntennさんの以前のプロポーザルを参考にさせてもらいました。
査読者目線からも、提案の整合性や発表内容に対する時間配分の妥当性などが分かるのでとても良いセクションだと思います。</p><ul><li><a href=https://github.com/monochromegane/conference-proposals/blob/master/2019-07-24-gophercon-2019.md>Proposal for GopherCon 2019</a></li></ul><h2 id=プロポーザルを英語化する>プロポーザルを英語化する</h2><p>まず、Google翻訳に放り込みたくなる気持ちをぐっと我慢します。
Google翻訳の進歩は目覚ましいですが、元となる日本語の文章に曖昧な点があるとどうしても翻訳の精度は下がります。
また、係り受けの複雑な日本語の文章も、いたずらに長い文章へ翻訳され、文字数あたりの情報量が減ることもあるでしょう。
査読者の思考を妨げないためには、簡潔で明解な英語文章が必要です。
そのためには、元の日本語の文章を以下の点でチェックすると良さそうです。</p><ul><li>主語・述語があるか</li><li>主語・述語がねじれていないか</li><li>事実か意見かが判断できるか</li><li>係り受けが適切か（不要な修飾を減らす、修飾順番を整理）</li><li>文章が複数の主張を含んでいないか（文の分割を検討）</li><li>接続助詞（〜が、〜て、〜ので）は従属節との関係を曖昧にしていないか（厳密な接続助詞への変更か文を分割）</li></ul><p>校正後の日本語文章に対しては、比較的短く基本的な構文だけで英作文ができるはずです。
なお、専門用語や言い回しについては、普段から興味のある分野で論文や技術書を英語のものを読んで、レパートリーを増やしておくと良いです（自戒を込めて）。</p><h2 id=ギリギリの提出を避ける>ギリギリの提出を避ける</h2><p>提出時期は早ければ早いほど良いでしょう。
今回、締め切りの5日前に提出しましたが、アーリーフィードバックとして、セッション枠の変更（25分ではなく45分へ）をはじめとする幾つかの提案をもらいました。
これが締め切り寸前だと、もらえなかったかもしれず、そうすると時間に対するコンテンツ過剰によって発表の実現性が低く採点され、採択されなかった可能性もあります。</p><p>実際、投稿数の遷移について、締め切り3日前が87、前日で130、当日の中間発表で192のように駆け込みで投稿数が一気に増える様が伝えられています。
査読者数も限界があるため、締め切り前の全員分にアーリーフィードバックを返せないとすると、提出は早いほうがオススメです。</p><p>僕がもらったフィードバックはこのようなものでした。</p><pre><code class=language-txt>I have some early feedback from the reviewers. The general feeling is this is too much content to cover in a 25 minute keynote slot and may not be generally applicable to the full audience. The recommendation from the reviewers is to revise this proposal as a 45 minute tutorial session

You can edit your proposal at any time before the end of the month. Best of luck!
</code></pre><h1 id=英語学習>英語学習</h1><p>英語によるコミュニケーションは普段からの積み重ねが全てです（はい&hellip;）。
この章に関しては誇れるものではないので参考までにお読みください。</p><p>僕の場合、発作的に英語をやって身につかずに終わるというのを長年繰り返していました。
そこで、今回、<a href=https://www.progrit.co.jp/>PROGRIT</a>という英語コーチングサービスを使ってカリキュラムを組んでもらい継続的な学習をサポートしてもらうことにしました。
結構なお値段（いやほんと）します。
カリキュラムも画期的な手法というよりは地道にやることで効果が見込める王道のものを組み合わせていて、これを如何に継続してやり抜くかをサポートすることがサービスのコアかなと感じます。
なので、自分にあった勉強法を見つけて継続してやれている方にとってはあまり意味のないサービスかもしれません。
とはいえ、前述の英語に対する僕のニーズにはあっていたので今回利用しました。
結果的に、Versantという英語コミュニケーション能力を図るテストは3ヶ月のカリキュラムを終えて5点上がり（TOEICだと75点UPぐらい？）、やはり継続は力だなと感じています。</p><h2 id=カリキュラム>カリキュラム</h2><p>最終的に日々のカリキュラムは以下のように落ち着きました。</p><ul><li>瞬間英作文(60min)</li><li>単語(30min)</li><li>シャドーイング(45min)</li><li>多読(45min)</li></ul><p>登壇と質疑応答、そしてスピーカーディナーで自分の考えを述べられることを目標に進めました。
英文法についてはなんとか理解しているものの、それらを「使う」ことの準備がほぼできていないことが分かったため、そこを補強するカリキュラムとなっています。
つまり、英語を使ったコミュニケーションに必要な、文章や単語を通した概念と音声の変換に関する、知覚と瞬発力を鍛えます。</p><p>まず単語は何をやるにも基礎となるのでひたすらボキャブラリを増やします。
僕はキクタンを使って自分のレベルにあったものから進めました。
一方で、発表に向けては普段から興味のある分野で論文や技術書を英語のものを読んで、ボキャブラリを増やしておくと良いのだろうなとも思いました。</p><p>次に、概念と文章をつなぐ瞬発力向上のために、瞬間英作文をやりました。
機械的に翻訳するような平易なものを瞬間で解くのはパズルのようで面白いですが、繰り返すと飽きてくるので覚えた英単語と組み合わせたりして応用するものいいかもしれません。</p><p>逆に、文章を概念につなぐ瞬発力向上には、多読をやりました。
戻り読みをしないという制約で、なるべく意味を理解しながらなるべく速く読みます（85%ぐらい理解しつつ1分あたり何word読めるかのスコアを伸ばす）。
音が明確に聞こえたとしても（つまりテキストとして渡されたとしても）それを読んで理解できるスピード以上には意味理解が追いつかないよねという経験を経てこれも頑張るようになりました。
自分にあったレベルのやつでやらないと途端につまらなくなるので教材選びが大事かも。</p><p>音と文章（単語）をつなぐ知覚向上にはシャドーイングをやりました。
英語音源をテキストを見ずに少し遅れて聞こえたまま繰り返すという学習法です。
30秒から60秒ぐらいの音源を1日50回とか繰り返しました&hellip;
最初は聞こえないし口がついていかないしで「こんなんできるかボケ」と面談で悪態をついてばかりいたのですが、最終的にはこれがヒアリング力の向上につながったと思っています。
では素直にヒアリング練習で良いのではないかと思えますが、口が回るようになったところが聞こえるようになるという経験を経て、頑張って繰り返すようになりました。
また、多読と並行することで、こちらでは意味理解よりも知覚に集中できるようになったのも良かったです。
以前に比べれば耳の解像度が上がったんじゃないかなあとVersantを前後で受けて見て思えます。</p><p>文章（単語）と音をつなぐ発話、発音は今回やっていません。
最初の面談で、まあ全く通じないというわけではないでしょうということで、上記のものを優先して進めました。
とはいえ、実際の発表ではやはりもう少しうまく発音できたらなあと思うこともあったので引き続きやっていこうと思います。</p><p>また、オンライン英会話についても（少ししか）やっていません。
本当は実践が一番なのでしょうが、あまりにも引き出しが少ないと英会話の時間が苦痛になるため、英語学習がだれてきた時のカンフル剤としてたまにやる感じにして基礎を頑張りました。</p><hr><p>毎日3時間を確実に取れたわけではなく、発表前は資料作成の方へ専念したりもしましたが、それなりの時間を投入しながらも全然使いこなせる感じがしないので、英語学習は奥が深いなあと思います。
それでも続けることで成果は出るので地道にやっていきましょう。</p><h1 id=発表資料>発表資料</h1><p>資料は一ヶ月ぐらい前から作り始めました。
日本語の元となる資料があることだし十分余裕を持って着手したつもりでしたが、もう少し早くに着手しても良かったなというのが終わって見ての感想です。
理由は母国語に頼らず説明するためには、資料の刷新と英語スクリプトの準備が必要だったからです。
更には、発表練習についても日本語で行う時よりも何倍も時間をかける必要がありました。
ですので、国際カンファレンスに臨むにあたっては余裕を持った準備をお勧めします（実際には渡航のための準備ややるべき仕事もありますし）。</p><h2 id=発表資料-1>発表資料</h2><p>スライドの構成は、基本的にプロポーザルの内容に沿うことになります。
先ほどの例であれば、イントロダクション（現状、背景）、提案、評価、まとめの流れが王道でしょうか。</p><p>大きなカンファレンスでの発表資料はイントロダクションを少し工夫すると良いかもしれません。
なぜなら同じカンファレンスであっても参加者が多い場合は個々のバックグラウンドや問題意識が多様であり、導入部分で揃えておかなければならないからです。
具体的には、トークの対象となるキーワードや問いなどを簡潔な形で伝えます。
GopherConでは、キーワードを端的に表す写真とともに、「〜のような経験はないか」のような共感を引く導入が多かったように思えました。
僕の資料では、少し前提が複雑だったので、最初の立てた問いをいくつかの実験結果を通して変化させていくような導入にして、より詳しい問題意識を共有するような作りにしました。</p><p>また、各所の構成はやや冗長であっても、大枠を示してから詳細に移るのを意識しました。
これは聴衆が置いてけぼりになることを避けるためです。
もちろん母国語の資料であっても気をつけるべきところではありますが、残念ながら、英語力が足りない場合、細かなフォローアップがその場その場でできないこともあり、資料の時点でその工夫はしておいた方が良いと思われます。
簡単な例であれば、例えば解決したい課題が3つあるならば、先に列挙してそれらに番号を振っておくでもいいですし、解決編では先にゴールを述べておくでも良いと思います。
僕の資料では、簡単なアプローチから出発して少しづつ課題を解決していくようにすることで、比較的複雑な箇所の説明の際に飛躍がないよう気をつけました。</p><p>図で説明できるものは図を用意する方が良いと思います。
ただし、図に頼って文章を考えなくていいわけではないので、あくまで聴衆の理解を助ける機会をできるだけ増やすという意識で用意します。</p><p>細かい点ですが、ページ番号は必ずスライドテンプレートに組み込んでおきましょう。
質疑の時のやりとりがスムーズになります。
また、ページ番号もそうですが、グラフの凡例なども視認できる大きさのフォントにしておくのも大切です（僕のは凡例が小さかった）</p><p>僕の発表資料はこちらです。</p><ul><li><a href=https://speakerdeck.com/monochromegane/optimization-for-number-of-goroutines-using-feedback-control>Optimization for Number of goroutines Using Feedback Control</a></li></ul><h2 id=発表者ノート-英語スクリプト>発表者ノート（英語スクリプト）</h2><p>英語に不慣れな場合は、一度、発表者ノート（英語スクリプト）を書き出しておくのをお勧めします。
発表者ノートを作成する利点は以下の通りです。</p><ul><li>曖昧な箇所や飛躍がある点を潰すことができる</li><li>原稿段階で英語話者に並行してチェックしてもらえる</li><li>発表の再現性が高まる（特に時間）</li></ul><p>いずれも伝えるべきことを全て伝えられるようにするために必要なことだと思います。
そのため、暗記するにしても読み上げるにしても、英語スクリプトは作っておく方が良いでしょう。</p><p>Keynoteであれば発表者ノート機能で手元に写しながら発表に臨むことができます。
ただし、演台があるか手元にPCが置けるかなどは事前に問い合わせて確認しておきましょう。</p><p>発表原稿では以下を気をつけました。</p><ul><li>章や節の始めに、ここでは何を説明するのかを一言で伝える。</li><li>章や節の終わりに、ここで伝えたかったことのサマリ、次に何を説明するかを一言入れる。</li><li>1ページあたりの文章が多いのであればページの分割を検討する（発表時に発表者ノートをスクロールするのは結構大変）</li><li>平易な文で記述する</li></ul><p>最後の平易な文については、自分の理解できるレベルの文章でスクリプトを作っておくということです。
発表時は発表者ノートに釘付けで話すわけにはいかないため、さっと見て、ある程度自分自身で意味がわかる文法や単語で構成していないと、強調する文章なのか判断つかずに読み上げる不自然な感じになってしまいます。
不慣れな言語でも自分自身が納得して説明できるように書いておきましょう（残念ながらここの段階で急には英語力は伸びません）。</p><p>また、できるだけ英語話者に原稿はチェックしてもらうと良いでしょう。
結構な分量になるので、知り合いに頼むとかよりもできるだけお金を払って英文校正サービスなどでチェックをすると良いと思います。
僕の場合は、先ほどのコーチが買って出てくれたのでお願いできました（コーチによるのでこれを期待してPROGRIT申し込まないように）</p><p>僕の英語スクリプトはこちらです。</p><ul><li><a href=https://blog.monochromegane.com/blog/2019/08/10/gophercon_2019/>GopherCon 2019: Optimization for Number of goroutines Using Feedback Control</a></li></ul><h2 id=発表練習>発表練習</h2><p>英語に不慣れな場合、暗記かスクリプトの読み上げになってしまいますが、一本調子だと聴衆はどこで共感するか反応するかの情報量が少なくなり混乱してしまいます。
その余裕を持つために、英語スクリプトを自分自身で意味がわかる文法や単語で構成することを提案しました。
それでもまだ目が滑ってしまう場合は、文に区切りを入れるのも良いでしょう。
区切りは関係詞や節の間で適当な単語数のところで入れました（変なところで区切ると逆に不自然になるので気をつけます）</p><p>僕の発表者ノートはこんな感じになっています。</p><pre><code class=language-txt>I am developing a fast grep tool / named &quot;the platinum searcher&quot;.
One day I conducted a measurement / of the optimal number of goroutines / to achieve good performance.
</code></pre><p>そして、定型の言い回し（I found that など）なるべく流暢にしたり、強調したいところは少しゆっくり大きく言うような工夫を入れました。</p><p>ただし、これはあくまで、僕の場合のネイティブの発音じゃない状態で文全体を早口で言うよりはこの方が伝わる可能性が高いねとコーチと試行錯誤した結果です。
つまり「今の」英語力でできるだけ伝えるための工夫であり、本来は継続的な英語の学習によって自然な状態に近づけていくようにすることが大切だと思います。</p><p>あとは、英語話者もしくは読み上げ機能で録音した音源を繰り返し聞き、繰り返し練習します。
また、良く出てきたり重要な単語は個別に練習しておくと良いでしょう（僕の場合はperformanceやdetermineなど）</p><h2 id=資料のバックアップ>資料のバックアップ</h2><p>現地の環境がわからないので、資料は複数の手段でアクセスできるようにしておくべきです。
GopherConの場合は、持参したPCとプロジェクタとの接続がうまくいかない場合に備えて、USBメモリにファイルをバックアップしておくよう指示がありました。
僕は発表者ノートが見れない状況を想定して念のため日本でスクリプトを印刷してカバンに忍ばせておきました。
また現地の発表練習では、代替機がMacとは限らないのでPDFや画像ファイルといったポータブルな形式にしたり、クラウドストレージやSpeakerdeckにアップロードしておいたりスクリプトもクラウドストレージにアップロードしてiPhoneから見れるようにしておいてもいいかもねとコメントもらいました。</p><h1 id=渡航>渡航</h1><p>アメリカの場合、パスポートの他にESTAの申請が必要なので忘れないようにしましょう。
何もなければパスポートは10日間、ESTAは2週間ほどで発行・承認されますが、ギリギリにやると不測の事態に対応できないため、採択されたらすぐ申請ぐらいでいいと思います。
渡航前は発表練習であまり余裕ないので&hellip;</p><p>また、海外渡航に不慣れな人は時差ボケを解消する時間も込みで日程を組むことを忘れないようにしましょう。
僕は時差-16時間のサンディエゴで発表でしたが、現地時間の前日入り(日本の7/24 夕方発 現地7/24午前着)してしまい、翌日のお昼すぎ(<sup>7</sup>&frasl;<sub>25</sub> 日本時間 午前6時)という時差ボケが激しい時間帯に発表になってしまいました。
@tenntennさんに「なんてやんちゃな日程だ」と言われてしまった&hellip;
この場合は最低でももう一日前(日本の7/23 夕方発 現地7/23午前着)して、翌日(<sup>7</sup>&frasl;<sub>24</sub>)で日中眠らずに現地時間に合わせて当日(<sup>7</sup>&frasl;<sub>25</sub>)に合わせるぐらいがいいらしいです。
時差ボケは自分の発表だけでなく、他の発表を聞くときの集中力にも影響してくるのでできるだけ万全の体制で臨めるようにしたいものです。</p><p>現地の移動はタクシーではなくUberを使いました。
Uberであれば、アプリから先に行き先を入力し、評価の高いドライバーを選択し、金額を確定しておくことができます。
Comfort系を選ぶとちょっと高いですがゆったりした車になるので複数名の場合はそちらを選ぶと良いみたいです。
サンディエゴだと大体10分ほどで来てくれます。
ドライバの現在地、車種とナンバーが事前に分かっているので、それを探します。
また、アプリは画面に色がつくので、その画面を振ってドライバに見つけてもらう感じです。
移動はアプリで現在地が分かるため安心です（そもそも事前に金額確定なので遠回りして稼ぐような動機がない）。
日本でアプリをインストールし、クレジットカードまで登録しておくと良いでしょう。
それから、自分のアカウントにきちんと顔写真登録しておく方が良いみたいです（ドライバーさん側への安心感かな？）
決済は到着後にプッシュ通知が来るのでチップの額を上乗せして終了です。便利便利。</p><h1 id=発表>発表</h1><p>あとはこれまでやって来たことを信じて発表するだけです。
せっかく自分の提案を国際カンファレンスで聞いてもらえる機会なので楽しんでいきましょう。
会場の雰囲気はとても良く、とても積極的に聞いてくれます。
なぜならカンファレンスに来ている人は、上手い下手をジャッジしに来てるのではなくて、僕たちの提案を経験をできるだけ聞きたいと言う姿勢で来てくれているからです。
どうしても緊張する人は、前方の10人だけをターゲットに最初の挨拶を元気に言うことだけ考えましょう。
あとは練習した通りに体と口が動いてくれます。</p><p>発表後は、おそらく色々なところで質問や感想のために声をかけてもらえます。
これはスピーカーとしてカンファレンスに参加したときの特典なので是非とも活かしたいところです。
ですので、余裕があれば想定問答や提案のサマリ、自己紹介などを事前にまとめておくと良いと思います。</p></div><footer class=tag><i class="fa fa-tags tag-icon"></i><ul><li><a class=tag-link href=/tags/gophercon>gophercon</a></li></ul><div class=clear></div></footer></div></article><a href=/post/ class=archives>Archives</a></div></div><footer class=footer><div class=author></div><p class=author-name><a href=https://twitter.com/monochromegane target=_blank>@monochromegane</a></p><p>monochromegane (モノクロめがね) と申します。</p><p>最近はもっぱらGoに夢中です。普段は研究開発をやっています。</p><ul class=social><li><a href=https://twitter.com/monochromegane target=_blank><i class="fa fa-twitter"></i></a></li><li><a href=https://github.com/monochromegane target=_blank><i class="fa fa-github"></i></a></li><li><a href=/index.xml target=_blank><i class="fa fa-rss"></i></a></li></ul><p class=copyright><small>&copy; <span>Powered by <a href=http://gohugo.io target=_blank>Hugo</a>, Designed by <a href=https://twitter.com/keita_kawamoto target=_blank>&copy;keita_kawamoto</a></span></small></p></footer><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/languages/go.min.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/languages/vim.min.js></script><script>hljs.initHighlightingOnLoad();</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-38374674-1','auto');ga('send','pageview');</script></body></html>